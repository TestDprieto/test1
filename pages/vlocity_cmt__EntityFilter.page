<apex:page standardcontroller="vlocity_cmt__EntityFilter__c" tabStyle="vlocity_cmt__EntityFilter__c"  extensions="vlocity_cmt.EntityFilterController">
<style type="text/css">
[ng\:cloak], [ng-cloak], .ng-cloak {
		  display: none !important;
		}
</style>
	
	<apex:form html-ng-app="entityApp" html-ng-controller="ObjectController as objCtr" styleClass="ng-cloak">
		<apex:sectionheader title="Vlocity Entity Filter Edit" subtitle="{!if(entityFilter.Id==null,'New Vlocity Entity Filter',entityFilter.Name)}"></apex:sectionheader>
	 	<apex:pageblock mode="edit" id="entityFilterpb" title="Vlocity Entity Filter Edit">
			<!-- action buttons -->
		 	<apex:pageblockbuttons >
				<apex:commandbutton action="{!save}" value="{!$Label.vlocity_cmt__save}"></apex:commandbutton>
				<apex:commandbutton action="{!saveNew}" value="{!$Label.vlocity_cmt__saveandnew}"></apex:commandbutton>
				<apex:commandbutton action="{!cancel}" value="{!$Label.vlocity_cmt__cancel}"></apex:commandbutton>
		 	</apex:pageblockbuttons>

		 	<!-- displays all message generated by the component -->
		 	<apex:pagemessages ></apex:pagemessages>
		 
			<apex:pageblocksection id="entityFilterInformationPBS" title="Information">         
				<apex:repeat value="{!editFields}" var="f">   
              		<apex:inputField value="{!entityFilter[f]}" rendered="{!(f != FOOName) }"/> 
              		<apex:pageBlockSectionItem rendered="{!(f == FOOName)}">
					<apex:outputLabel value="{!FOOLabel}" for="filterOnObj"/>
					<apex:outputPanel >
					<select id="filterOnObj" ng-model="objCtr.selectedObj">
						<option ng-repeat=" obj in objCtr.objList" ng-value="obj.value" ng-selected="obj.value == objCtr.selectedObj">
	                    	{{obj.label}}
	                    </option>
	                <apex:inputHidden value="{!selectedObj}" html-ng-value="objCtr.selectedObj"/>
	                </select>
	                </apex:outputPanel>
                </apex:pageBlockSectionItem>
            	</apex:repeat>
				
			</apex:pageblocksection>
		</apex:pageblock>
	</apex:form>

	<script type="text/javascript">
		angular.module('entityApp', []);
		(function(){
		function ObjectController (baseServ) {
			var self = this;
			self.objList = angular.fromJson({!objectListAsJson});
			self.selectedObj = "{!FOOValue}";
		};
		
		angular.module('entityApp').controller('ObjectController',[ObjectController]);
	})();
	</script>
	<apex:includeScript value="{!URLFOR($Resource.vlocity_cmt__AngularJS)}"/>

</apex:page>