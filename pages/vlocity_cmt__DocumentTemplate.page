<apex:page standardStylesheets="false" showHeader="true" sidebar="false" controller="vlocity_cmt.DocumentTemplateDisplayController">
    <apex:includeLightning />

    <html xmlns:ng="http://angularjs.org" lang="en">
        <head>
            <meta charset="utf-8"/>
            <base href="/apex/DocumentTemplate"/>

            <apex:includeScript value="/soap/ajax/37.0/connection.js"/>
            <apex:includeScript value="/xdomain/xdomain.js"/>
            <apex:includeScript value="{!URLFOR($Resource.vlocity_cmt__vlocity_core_assets, '/latest/vlocity_core_assets.js')}"/>
            <apex:includeScript value="{!URLFOR($Resource.vlocity_cmt__angular_strap_bundle_1_6)}"/>
            <apex:includeScript value="{!URLFOR($Resource.vlocity_cmt__vlocity_assets, '/bower_components/angular-drag-and-drop-lists/angular-drag-and-drop-lists.js')}"/>
            <apex:includeScript value="{!URLFOR($Resource.vlocity_cmt__vlocity_assets, '/javascripts/segjs.js')}"/>
            <apex:includeScript value="{!URLFOR($Resource.vlocity_cmt__dropzone, '/dist/min/dropzone.min.js')}"/>
            <apex:includeScript value="{!URLFOR($Resource.vlocity_cmt__tinymce, '/js/tinymce/tinymce.min.js')}"/>
            <apex:includeScript value="{!URLFOR($Resource.vlocity_cmt__ui_tinymce, '/src/tinymce.js')}"/>
            <apex:includeScript value="{!URLFOR($Resource.vlocity_cmt__docgenutil, 'docgenFieldMappingUtils.js')}"/>
            <apex:includeScript value="{!URLFOR($Resource.vlocity_cmt__docxtemplater_bundle, '/jszip/jszip.min.js')}"/>
            <apex:includeScript value="{!URLFOR($Resource.vlocity_cmt__docxtemplater_bundle, '/vendor/jszip-utils.js')}"/>
            <apex:includeScript value="{!URLFOR($Resource.vlocity_cmt__docxtemplater_bundle, '/vendor/file-saver.min.js')}"/>
            <apex:includeScript value="{!URLFOR($Resource.vlocity_cmt__docxtemplater_bundle, '/build/docxtemplater.v3.5.0.min.js')}"/>
            <apex:includeScript value="{!$Resource.vlocity_cmt__ViaDirectives}"/> 
            <apex:includeScript value="{!$Resource.vlocity_cmt__SldsAngular}"/>
            <apex:includeScript value="{!$Resource.vlocity_cmt__DocumentTemplateApp}"/>
            <apex:includeScript value="{!$Resource.vlocity_cmt__DocxGenerateSections}"/>
            
            <apex:stylesheet value="{!URLFOR($Resource.vlocity_cmt__slds, '/assets/styles/salesforce-lightning-design-system-vf.min.css')}"/>
            <apex:includeScript value="/support/console/42.0/integration.js"/>
            <apex:stylesheet value="{!URLFOR($Resource.vlocity_cmt__vlocity_assets, '/css/font-hack.css')}"/> 
            <apex:stylesheet value="{!URLFOR($Resource.vlocity_cmt__dropzone, '/dist/min/dropzone.min.css')}"/>
            <apex:stylesheet value="{!$Resource.vlocity_cmt__DocumentBaseCss}" />
            <apex:stylesheet value="{!$Resource.vlocity_cmt__DocumentTemplateCss}" />

            <!-- PDFTRON Libraries for salesforce side implementation-->
            <!-- <apex:includeScript value="{!URLFOR($Resource.cs_pdftron_lib, '/core/external/jquery-3.5.1.min.js')}"/> -->
            <apex:includeScript value="{!URLFOR($Resource.vlocity_cmt__cs_pdftron_lib, '/core/CoreControls.js')}"/>
            <apex:includeScript value="{!URLFOR($Resource.vlocity_cmt__cs_pdftron_lib, '/core/pdf/PDFNet.js')}"/>
            <apex:includeScript value="{!$Resource.vlocity_cmt__cs_pdftron_documentgeneration}"/>
            <apex:includeScript value="{!URLFOR($Resource.vlocity_cmt__docxtemplater_bundle, '/domPurify/domPurify.min.js')}"/>

        </head>
        <body>
            <div class="vloc-body ng-cloak" ng-app="documentTemplateApp" ng-controller="initDocumentTemplateCtrl">
                <div class="slds-spinner_container" ng-show="vlcLoading">
                    <div class="slds-spinner slds-spinner_brand slds-spinner_large" aria-hidden="false" role="status">
                        <div class="slds-spinner__dot-a"></div>
                        <div class="slds-spinner__dot-b"></div>
                    </div>
                </div>
                <div ng-if="pageParams.templateType === CONST.WEB || pageParams.templateType === CONST.UNDEFINED">
                    <web-template-type page-params="pageParams"></web-template-type>
                </div>
                <div ng-if="pageParams.templateType === CONST.DOCX || pageParams.templateType === CONST.PPTX">
                    <docx-template-type page-params="pageParams"></docx-template-type>
                </div>
                <div id="lightningFilePreview"></div>
            </div>

            <c:TokenMappingComponent />
            
            <script type="text/javascript">

            /**
             * Foundation package global variables
             **/
            window.IsFoundation = {!JSENCODE(IF(isFoundation, "true", "false"))};
            window.DocTemplateFieldMappings = JSON.parse('{!JSENCODE(docTemplateFieldMappings)}'); 
            window.nameSpacePrefix = '{!nameSpacePrefix}';
            window.bOmnistudio = {!bOmnistudio};
            _.noConflict();
                window.sessionId = '{!vlocAccessToken}';
                window.orgId = '{!$Organization.Id}';
                window.userLocale = '{!userLanguageLocale}';

                var pdfGenerationSource = '{!JSENCODE(pdfGenerationSource)}';
                Visualforce.remoting.timeout = 120000; // Set timeout at page level

                var remoteActions = {
                    getAllCloneableTemplates: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getAllCloneableTemplates}',
                        config: {escape: false}
                    },
                    getSectionsForTemplate: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getSectionsForTemplate}',
                        config: {escape: false}
                    },
                    getTypeValues: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getTypeValues}',
                        config: {escape: false}
                    },
                    getApplicableTypeValues: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getApplicableTypeValues}',
                        config: {escape: false}
                    },
                    getApplicableItemTypeValues: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getApplicableItemTypeValues}',
                        config: {escape: false}
                    },
                    getSectionTypes: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getSectionTypes}',
                        config: {escape: false}
                    },
                    getClauses: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getClauses}',
                        config: {escape: false}
                    },
                    getTemplateData: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getTemplateData}',
                        config: {escape: false}
                    },
                    getGenericClauses: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getGenericClauses}',
                        config: {escape: false}
                    },
                    getTemplateTypeValues: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getTemplateTypeValues}',
                        config: {escape: false}
                    },
                    getTemplateLanguages: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getTemplateLanguages}',
                        config: {escape: false}
                    },
                    saveTemplate: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.saveDocTemplate}',
                        config: {escape: false}
                    },
                    getTemplateTokens: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getTemplateTokens}',
                        config: {escape: false}
                    },
                    saveTemplateSection: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.saveTemplateSection}',
                        config: {escape: false}
                    },
                    saveAllSections: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.saveAllSections}',
                        config: {escape: false}
                    },
                    deleteTemplateSection: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.deleteTemplateSection}',
                        config: {escape: false}
                    },
                    deleteTemplateSections: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.deleteTemplateSections}',
                        config: {escape: false}
                    },
                    cloneAllSections: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.cloneAllSections}',
                        config: {escape: false}
                    },
                    cloneDocumentTemplate: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.cloneDocumentTemplate}',
                        config: {escape: false}
                    },
                    deactivateTemplate: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.deactivateTemplate}',
                        config: {escape: false}
                    },
                    deleteTemplate: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.deleteTemplate}',
                        config: {escape: false}
                    },
                    createNewVersion: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.createNewVersionOfDocumentTemplate}',
                        config: {escape: false}
                    },
                    getAllFolders: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getAllFolders}',
                        config: {escape: false}
                    },
                    getAllImages: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getAllImages}',
                        config: {escape: false}
                    },
                    getDocuSignSignatureTabs: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getDocuSignSignatureTabs}',
                        config: {escape: false}
                    },
                    getTemplateProducts: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getTemplateProducts}',
                        config: {escape: false}
                    },
                    getProducts: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getProducts}',
                        config: {escape: false}
                    },
                    getEntityFilters: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getSObjectEntityFilters}',
                        config: {escape: false}
                    },
                    getTemplateConditions: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getTemplateConditions}',
                        config: {escape: false}
                    },
                    validateCustomClass: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.validateCustomClass}',
                        config: {escape: false}
                    },
                    createEntityFilter: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.createSObjectEntityFilter}',
                        config: {escape: false}
                    },
                    getTrackChangeSetting: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getTrackChangeSetting}',
                        config: {escape: false}
                    },
                    getDocumentTemplateWorkspace: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getDocumentTemplateWorkspace}',
                        config: {escape: false}
                    },
                    getContractTypeList: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getContractTypeList}',
                        config: {escape: false}
                    },
                    getDefaultContractType: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getDefaultContractType}',
                        config: {escape: false}
                    },
                    isEntityFilterEmpty: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.isEntityFilterEmpty}',
                        config: {escape: false}
                    },
                    getFieldLabels: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getFieldLabels}',
                        config: {escape: false}
                    },
                    getDRBundleId: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getDRBundleId}',
                        config: {escape: false}
                    },
                    getUsageValues: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getUsageValues}',
                        config: {escape: false}
                    },
                    saveDocxRelMetadata: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.saveDocxRelMetadata}',
                        config: {escape: false}
                    },
                    getGenericDocGenOSURL: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getGenericDocGenOSURL}',
                        config: {escape: false}
                    },
                    generateGUID: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.generateGUID}',
                        config: {escape: false}
                    },
                    searchDocumentTemplates: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.searchDocumentTemplates}',
                        config: {escape: false}
                    },
                    getDocumentTemplatesById: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getDocumentTemplatesById}',
                        config: {escape: false}
                    },
                    setTemplateContentVersionDocx: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.setTemplateContentVersionDocx}',
                        config: {escape: false}
                    },
                    getClauseContentForDocx: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getClauseContentForDocx}',
                        config: {escape: false}
                    },
                    getDocxTemplateSectionHtmlContent: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getDocxTemplateSectionHtmlContent}',
                        config: {escape: false}
                    },
                    linkContentVersionToTemplateElement: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.linkContentVersionToTemplateElement}',
                        config: {escape: false}
                    },
                    getPDFIntegrationConfig: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getPDFIntegrationConfig}',
                        config: {escape: false}
                    },
                    getClientSidePdfLibraries: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getClientSidePdfLibraries}',
                        config: {escape: false}
                    },
                    getDocumentGenerationMethods: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getDocumentGenerationMethods}',
                        config: {escape: false}
                    },
                    getPdfGenerationMethods: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.getPdfGenerationMethods}',
                        config: {escape: false}
                    }, 
                    deleteDocxFiles: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.deleteDocxFiles}',
                        config: {escape: false}
                    },
                    isOsFirstThenVertical: {
                        action: '{!$RemoteAction.DocumentTemplateDisplayController.isOsFirstThenVertical}',
                        config: {escape: false}
                     }
                };
                var modalLabels = {
                    'CLMPleaseReviewDRCustomClass' : '{!$Label.vlocity_cmt__CLMPleaseReviewDRCustomClass}',
                    'CLMClauseClose': '{!$Label.vlocity_cmt__CLMClauseClose}',
                    'CLMTemplateTemplateDetails': "{!$Label.vlocity_cmt__CLMTemplateTemplateDetails}",
                    'CLMTemplateTemplateName': '{!$Label.vlocity_cmt__CLMTemplateTemplateName}',
                    'CLMTemplateActive': '{!$Label.vlocity_cmt__CLMTemplateActive}',
                    'CLMTemplateVersion': '{!$Label.vlocity_cmt__CLMTemplateVersion}',
                    'CLMTemplateSelectAllApplicableObjHeaders': '{!$Label.vlocity_cmt__CLMTemplateSelectAllApplicableObjHeaders}',
                    'CLMTemplateSelectAllApplicableObjLines': '{!$Label.vlocity_cmt__CLMTemplateSelectAllApplicableObjLines}',
                    'CLMTemplateTrackContractRedlines': '{!$Label.vlocity_cmt__CLMTemplateTrackContractRedlines}',
                    'CLMTemplateTrackRedlines': '{!$Label.vlocity_cmt__CLMTemplateTrackRedlines}',
                    'CLMTemplateRestrictTemplateToContractTypes': '{!$Label.vlocity_cmt__CLMTemplateRestrictTemplateToContractTypes}',
                    'CLMTemplateSpecifyContractTypes': '{!$Label.vlocity_cmt__CLMTemplateSpecifyContractTypes}',
                    'CLMTemplateAllContractTypes': '{!$Label.vlocity_cmt__CLMTemplateAllContractTypes}',
                    'CLMTemplateSwitchToDefault': '{!$Label.vlocity_cmt__CLMTemplateSwitchToDefault}',
                    'CLMTemplateEditDocumentDefaultStyling': '{!$Label.vlocity_cmt__CLMTemplateEditDocumentDefaultStyling}',
                    'CLMTemplateDefaultFontFamilyDocument': '{!$Label.vlocity_cmt__CLMTemplateDefaultFontFamilyDocument}',
                    'CLMTemplateDefineStyleEachSectionHeading': '{!$Label.vlocity_cmt__CLMTemplateDefineStyleEachSectionHeading}',
                    'CLMTemplateSample': '{!$Label.vlocity_cmt__CLMTemplateSample}',
                    'CLMTemplateText': '{!$Label.vlocity_cmt__CLMTemplateText}',
                    'CLMTemplateSelectAllFontFormatsToApply': '{!$Label.vlocity_cmt__CLMTemplateSelectAllFontFormatsToApply}',
                    'CLMTemplateFontSize': '{!$Label.vlocity_cmt__CLMTemplateFontSize}',
                    'CLMTemplateFontColor': '{!$Label.vlocity_cmt__CLMTemplateFontColor}',
                    'CLMTemplateFontFamily': '{!$Label.vlocity_cmt__CLMTemplateFontFamily}',
                    'CLMTemplateSelectTextAlignment': '{!$Label.vlocity_cmt__CLMTemplateSelectTextAlignment}',
                    'CLMTemplateSelectIndentation': '{!$Label.vlocity_cmt__CLMTemplateSelectIndentation}',
                    'CLMTemplateCloneExistingTemplate': '{!$Label.vlocity_cmt__CLMTemplateCloneExistingTemplate}',
                    'CLMTemplateCancel': '{!$Label.vlocity_cmt__CLMTemplateCancel}',
                    'CLMTemplateClearClone': '{!$Label.vlocity_cmt__CLMTemplateClearClone}',
                    'CLMTemplateDeactivateTemplate': '{!$Label.vlocity_cmt__CLMTemplateDeactivateTemplate}',
                    'CLMTemplateCreateNewVersion': '{!$Label.vlocity_cmt__CLMTemplateCreateNewVersion}',
                    'CLMTemplateDeleteTemplate': '{!$Label.vlocity_cmt__CLMTemplateDeleteTemplate}',
                    'CLMTemplateTestTemplate': '{!$Label.vlocity_cmt__CLMTemplateTestTemplate}',
                    'CLMTemplateSignatureRequired': '{!$Label.vlocity_cmt__CLMTemplateSignatureRequired}',
                    'CLMTemplateSectionErrorsMsg': '{!$Label.vlocity_cmt__CLMTemplateSectionErrorsMsg}',
                    'CLMTemplateOkay': '{!$Label.vlocity_cmt__CLMTemplateOkay}',
                    'CLMTemplateUnsavedSectionsMsg': '{!$Label.vlocity_cmt__CLMTemplateUnsavedSectionsMsg}',
                    'CLMTemplateSaveTemplateVersionMsg': '{!$Label.vlocity_cmt__CLMTemplateSaveTemplateVersionMsg}',
                    'CLMTemplateSaveTemplate': '{!$Label.vlocity_cmt__CLMTemplateSaveTemplate}',
                    'CLMTemplatePickImg': '{!$Label.vlocity_cmt__CLMTemplatePickImg}',
                    'CLMTemplateSelectedImg': '{!$Label.vlocity_cmt__CLMTemplateSelectedImg}',
                    'CLMTemplateInsert': '{!$Label.vlocity_cmt__CLMTemplateInsert}',
                    'CLMTemplatePickSignerRole' :'{!$Label.vlocity_cmt__CLMTemplatePickSignerRole}',
                    'CLMTemplateAnchorString' :'{!$Label.vlocity_cmt__CLMTemplateAnchorString}',
                    'CLMTemplateSignerRoles' : '{!$Label.vlocity_cmt__CLMTemplateSignerRoles}',
                    'CLMTemplateSaveTemplateDetails': '{!$Label.vlocity_cmt__CLMTemplateSaveTemplateDetails}',
                    'CLMTemplateCloneTemplate': '{!$Label.vlocity_cmt__CLMTemplateCloneTemplate}',
                    'CLMTemplateDeleteSection': '{!$Label.vlocity_cmt__CLMTemplateDeleteSection}',
                    'CLMClauseAreYouSureDeleteSection': '{!$Label.vlocity_cmt__CLMClauseAreYouSureDeleteSection}',
                    'CLMClauseAreYouSureDeleteTemplate': '{!$Label.vlocity_cmt__CLMClauseAreYouSureDeleteTemplate}',
                    'CLMTemplateType': '{!$Label.vlocity_cmt__CLMTemplateType}',
                    'CLMTemplateTokenMapping': '{!$Label.vlocity_cmt__CLMTemplateTokenMapping}',
                    'CLMTemplateTokenMappingMethod': '{!$Label.vlocity_cmt__CLMTemplateTokenMappingMethod}',
                    'CLMTemplateTokenMappingChangeWarning': '{!$Label.vlocity_cmt__CLMTemplateTokenMappingChangeWarning}',
                    'CLMTemplateAutoAddSectionKeyChangeWarning': '{!$Label.vlocity_cmt__CLMTemplateAutoAddSectionKeyChangeWarning}',
                    'CLMTemplateExtractEmbeddedChangeWarning': '{!$Label.vlocity_cmt__CLMTemplateExtractEmbeddedChangeWarning}',
                    'CLMTemplateExtractEmbeddedWarningTitle': '{!$Label.vlocity_cmt__CLMTemplateExtractEmbeddedWarningTitle}',
                    'CLMTemplateAutoAddSectionWarningTitle': '{!$Label.vlocity_cmt__CLMTemplateAutoAddSectionWarningTitle}',
                    'CLMTemplateDefineDataMappingForToken':'{!$Label.vlocity_cmt__CLMTemplateDefineDataMappingForToken}',
                    'CLMTemplateForApplicableType':'{!$Label.vlocity_cmt__CLMTemplateForApplicableType}',
                    'CLMTemplateTokenMappingObjNoField':'{!$Label.vlocity_cmt__CLMTemplateTokenMappingObjNoField}',
                    'CLMTemplateApply':'{!$Label.vlocity_cmt__CLMTemplateApply}',
                    'CLMTemplateDefineMapping': '{!$Label.vlocity_cmt__CLMTemplateDefineMapping}',
                    'CLMTemplateEdit': '{!$Label.vlocity_cmt__CLMTemplateEdit}', 
                    'CLMTemplateEmptyFolder': '{!$Label.vlocity_cmt__CLMTemplateEmptyFolder}',
                    'CLMTemplateLanguage': '{!$Label.vlocity_cmt__CLMTemplateLanguage}',
                    'CLMTemplateTokenJSONFormatTitle': '{!$Label.vlocity_cmt__CLMTemplateTokenJSONFormatTitle}',
                    'CLMCopyToClipboard': '{!$Label.vlocity_cmt__CLMCopyToClipboard}',
                    'CLMClausePrefix':'{!$Label.vlocity_cmt__CLMClausePrefix}',
                    'CLMTemplateMissingClausesLabel':'{!$Label.vlocity_cmt__CLMTemplateMissingClausesLabel}',
                    'CLMTemplateNoClauseFoundWarningMessage':'{!$Label.vlocity_cmt__CLMTemplateNoClauseFoundWarningMessage}',
                    'CLMTemplateFoundWarningMessage':'{!$Label.vlocity_cmt__CLMTemplateFoundWarningMessage}',
                    'CLMTemplateClauseTokenFoundMessage':'{!$Label.vlocity_cmt__CLMTemplateClauseTokenFoundMessage}',
                    'CLMTemplateClickNext':'{!$Label.vlocity_cmt__CLMTemplateClickNext}',
                    'CLMTemplateNext':'{!$Label.vlocity_cmt__CLMTemplateNext}',
                    'PdfFontValidationWarningMsg' : '{!$Label.vlocity_cmt__PdfFontValidationWarningMsg}',
                    'PdfFontWarningTitle' : '{!$Label.vlocity_cmt__PdfFontWarningTitle}'
                };
                var labels = {
                    'CLMTemplateSectionErrorsExist' : '{!$Label.vlocity_cmt__CLMTemplateSectionErrorsExist}',
                    'CLMTemplateSectionNotSaved' : '{!$Label.vlocity_cmt__CLMTemplateSectionNotSaved}',
                    'CLMTemplateNoSectionsTemplate': '{!$Label.vlocity_cmt__CLMTemplateNoSectionsTemplate}',
                    'CLMTemplateClickAddNewSection' : '{!$Label.vlocity_cmt__CLMTemplateClickAddNewSection}',
                    'CLMTemplateCreateNewTemplateSetting': '{!$Label.vlocity_cmt__CLMTemplateClickAddNewSection}',
                    'CLMTemplateSectionNumbering': '{!$Label.vlocity_cmt__CLMTemplateSectionNumbering}',
                    'CLMTemplateSaveTemplateDetails': '{!$Label.vlocity_cmt__CLMTemplateSaveTemplateDetails}',
                    'CLMTemplateStartNewTemplate': '{!$Label.vlocity_cmt__CLMTemplateStartNewTemplate}',
                    'CLMTemplateEditTemplateDetails': '{!$Label.vlocity_cmt__CLMTemplateEditTemplateDetails}',
                    'CLMTemplateSaveAllSections': '{!$Label.vlocity_cmt__CLMTemplateSaveAllSections}',
                    'CLMTemplateCopy': '{!$Label.vlocity_cmt__CLMTemplateCopy}',
                    'CLMTemplateEmbeddedTemplate': '{!$Label.vlocity_cmt__CLMTemplateEmbeddedTemplate}',
                    'CLMTemplateViewing': '{!$Label.vlocity_cmt__CLMTemplateViewing}',
                    'CLMTemplateEditing': '{!$Label.vlocity_cmt__CLMTemplateEditing}',
                    'CLMTemplateOfTemplate':'{!$Label.vlocity_cmt__CLMTemplateOfTemplate}',
                    'CLMTemplateNowEditingVersion':'{!$Label.vlocity_cmt__CLMTemplateNowEditingVersion}',
                    'CLMTemplateTemplateIs':'{!$Label.vlocity_cmt__CLMTemplateTemplateIs}',
                    'CLMTemplateInactive':'{!$Label.vlocity_cmt__CLMTemplateInactive}',
                    'CLMTemplateCloneTemplate':'{!$Label.vlocity_cmt__CLMTemplateCloneTemplate}',
                    'CLMTemplateSelectExistingTempalte':'{!$Label.vlocity_cmt__CLMTemplateSelectExistingTempalte}',
                    'CLMTemplateDataFrom':'{!$Label.vlocity_cmt__CLMTemplateDataFrom}',
                    'CLMTemplateStartNewTemplate':'{!$Label.vlocity_cmt__CLMTemplateStartNewTemplate}',
                    'CLMTemplateChooseSectionType':'{!$Label.vlocity_cmt__CLMTemplateChooseSectionType}',
                    'CLMTemplateSaveSection':'{!$Label.vlocity_cmt__CLMTemplateSaveSection}',
                    'CLMTemplateDeleteSection':'{!$Label.vlocity_cmt__CLMTemplateDeleteSection}',
                    'CLMTemplateEditingSection':'{!$Label.vlocity_cmt__CLMTemplateEditingSection}',
                    'CLMTemplateActiveReadOnly':'{!$Label.vlocity_cmt__CLMTemplateActiveReadOnly}',
                    'CLMTemplateSaveTemplateDetails': '{!$Label.vlocity_cmt__CLMTemplateSaveTemplateDetails}',
                    'CLMTemplateSuccessfully':'{!$Label.vlocity_cmt__CLMTemplateSuccessfully}',
                    'CLMTemplateAllSectionsSaved':'{!$Label.vlocity_cmt__CLMTemplateAllSectionsSaved}',
                    'CLMTemplateSavedTemplateSection':'{!$Label.vlocity_cmt__CLMTemplateSavedTemplateSection}',
                    'CLMTemplateCustomClassNoImplementation':'{!$Label.vlocity_cmt__CLMTemplateCustomClassNoImplementation}',
                    'CLMTemplateCustomClassNoExtension':'{!$Label.vlocity_cmt__CLMTemplateCustomClassNoExtension}',
                    'CLMTemplateCustomClassNotExist':'{!$Label.vlocity_cmt__CLMTemplateCustomClassNotExist}',
                    'CLMTemplateAllSectionsForTemplate':'{!$Label.vlocity_cmt__CLMTemplateAllSectionsForTemplate}',
                    'CLMTemplateHaveSavedSuccessfully':'{!$Label.vlocity_cmt__CLMTemplateHaveSavedSuccessfully}',
                    'CLMTemplateClonedSuccessfully':'{!$Label.vlocity_cmt__CLMTemplateClonedSuccessfully}',
                    'CLMTemplateCustomClassCustomSectionNoImplementation':'{!$Label.vlocity_cmt__CLMTemplateCustomClassCustomSectionNoImplementation}',
                    'CLMTemplateValidationErrorsOneOrMoreSections':'{!$Label.vlocity_cmt__CLMTemplateValidationErrorsOneOrMoreSections}',
                    'CLMTemplateClonedNewTemplate':'{!$Label.vlocity_cmt__CLMTemplateClonedNewTemplate}',
                    'CLMTemplateTheTemplate':'{!$Label.vlocity_cmt__CLMTemplateTheTemplate}',
                    'CLMTemplateInactiveAndEditable':'{!$Label.vlocity_cmt__CLMTemplateInactiveAndEditable}',
                    'CLMTemplateHasBeenDeleted':'{!$Label.vlocity_cmt__CLMTemplateHasBeenDeleted}',
                    'CLMTemplateSeeMoreContracts':'{!$Label.vlocity_cmt__CLMTemplateSeeMoreContracts}',
                    'CLMTemplateCannotBeDeletedUsed':'{!$Label.vlocity_cmt__CLMTemplateCannotBeDeletedUsed}',
                    'CLMTemplateCannotBeDeactivatedUsed':'{!$Label.vlocity_cmt__CLMTemplateCannotBeDeactivatedUsed}',
                    'CLMTemplateEnterSectionName':'{!$Label.vlocity_cmt__CLMTemplateEnterSectionName}',
                    'CLMTemplateContentIs':'{!$Label.vlocity_cmt__CLMTemplateContentIs}',
                    'CLMTemplateCharactersExceedsLimit':'{!$Label.vlocity_cmt__CLMTemplateCharactersExceedsLimit}',
                    'CLMTemplateEnterSectionLineItem':'{!$Label.vlocity_cmt__CLMTemplateEnterSectionLineItem}',
                    'CLMTemplateEnterCustomClassName':'{!$Label.vlocity_cmt__CLMTemplateEnterCustomClassName}',
                    'CLMTemplateEnterTokenMapping':'{!$Label.vlocity_cmt__CLMTemplateEnterTokenMapping}',
                    'CLMTemplateEnterColumnHeader':'{!$Label.vlocity_cmt__CLMTemplateEnterColumnHeader}',
                    'CLMTemplateEnterColumnToken':'{!$Label.vlocity_cmt__CLMTemplateEnterColumnToken}',
                    'CLMTemplateEnterColumnHeaderAndToken':'{!$Label.vlocity_cmt__CLMTemplateEnterColumnHeaderAndToken}',
                    'CLMTemplateEnterColumnTokenFormat':'{!$Label.vlocity_cmt__CLMTemplateEnterColumnTokenFormat}',
                    'CLMTemplateTemplateNameExists':'{!$Label.vlocity_cmt__CLMTemplateTemplateNameExists}',
                    'CLMTemplateNameCharacterLimit':'{!$Label.vlocity_cmt__CLMTemplateNameCharacterLimit}',
                    'CLMTemplatePlsShorten':'{!$Label.vlocity_cmt__CLMTemplatePlsShorten}',
                    'CLMTemplateEnterTemplateName':'{!$Label.vlocity_cmt__CLMTemplateEnterTemplateName}',
                    'CLMTemplateSelectAtleastOne':'{!$Label.vlocity_cmt__CLMTemplateSelectAtleastOne}',
                    'CLMTemplateSelectAFile':'{!$Label.vlocity_cmt__CLMTemplateSelectAFile}',
                    'CLMTemplateEnterSectionContent': '{!$Label.vlocity_cmt__CLMTemplateEnterSectionContent}',
                    'CLMTemplateActive': '{!$Label.vlocity_cmt__CLMTemplateActive}',
                    'CLMTemplateColumnHeader':'{!$Label.vlocity_cmt__CLMTemplateColumnHeader}',
                    'CLMTemplateColumnTokens':'{!$Label.vlocity_cmt__CLMTemplateColumnTokens}',
                    'CLMTemplateTotalTokens':'{!$Label.vlocity_cmt__CLMTemplateTotalTokens}',
                    'CLMTemplateSectionHeading': '{!$Label.vlocity_cmt__CLMTemplateSectionHeading}',
                    'CLMTemplateConditionalJson': '{!$Label.vlocity_cmt__CLMTemplateConditionalJson}',
                    'CLMTemplateConditionalJsonSectionTabLabel': '{!$Label.vlocity_cmt__CLMTemplateConditionalJsonSectionTabLabel}',
                    'CLMTemplateConditionalJsonRepeatableTabLabel': '{!$Label.vlocity_cmt__CLMTemplateConditionalJsonRepeatableTabLabel}',
                    'CLMTemplateConditionalJsonPlaceholder': '{!$Label.vlocity_cmt__CLMTemplateConditionalJsonPlaceholder}',
                    'CLMTemplateConditionalJsonRepeatable': '{!$Label.vlocity_cmt__CLMTemplateConditionalJsonRepeatable}',
                    'CLMTemplateDRBundleName': '{!$Label.vlocity_cmt__CLMTemplateDRBundleName}',
                    'CLMTemplateDRBundleNamePlaceholder': '{!$Label.vlocity_cmt__CLMTemplateDRBundleNamePlaceholder}',
                    'CLMTemplateDRBundleIconText': '{!$Label.vlocity_cmt__CLMTemplateDRBundleIconText}',
                    'CLMTemplateDEDRBundleIconText': '{!$Label.vlocity_cmt__CLMTemplateDEDRBundleIconText}',
                    'CLMTemplateWordDocTemplateName': '{!$Label.vlocity_cmt__CLMTemplateWordDocTemplateName}',
                    'CLMTemplateWordDocTemplateNamePlaceholder': '{!$Label.vlocity_cmt__CLMTemplateWordDocTemplateNamePlaceholder}',
                    'CLMTemplateDataExtractDataBundleName': '{!$Label.vlocity_cmt__CLMTemplateDataExtractDataBundleName}',
                    'CLMTemplateDataExtractDataBundleNamePlaceholder': '{!$Label.vlocity_cmt__CLMTemplateDataExtractDataBundleNamePlaceholder}',
                    'CLMTemplateUsageType': '{!$Label.vlocity_cmt__CLMTemplateUsageType}',
                    'CLMTemplateDisplayUnmappedTokens': '{!$Label.vlocity_cmt__CLMTemplateDisplayUnmappedTokens}',
                    'CLMTemplateBackToList': '{!$Label.vlocity_cmt__CLMTemplateBackToList}',
                    'CLMTemplateTemplateSettings': '{!$Label.vlocity_cmt__CLMTemplateTemplateSettings}',
                    'CLMTemplateBackToSection': '{!$Label.vlocity_cmt__CLMTemplateBackToSection}',
                    'CLMTemplateActivate': '{!$Label.vlocity_cmt__CLMTemplateActivate}',
                    'CLMTemplateNoConditionalClauseFound': '{!$Label.vlocity_cmt__CLMTemplateNoConditionalClauseFound}',
                    'CLMTemplateSectionApplicableLineItemTypes': '{!$Label.vlocity_cmt__CLMTemplateSectionApplicableLineItemTypes}',
                    'CLMTemplateDisplayTotal': '{!$Label.vlocity_cmt__CLMTemplateDisplayTotal}',
                    'CLMTemplateToken': '{!$Label.vlocity_cmt__CLMTemplateToken}',
                    'CLMTemplateErrorEmptyFilters': '{!$Label.vlocity_cmt__CLMTemplateErrorEmptyFilters}',
                    'CLMTemplateEditAdvEntityFilters': '{!$Label.vlocity_cmt__CLMTemplateEditAdvEntityFilters}',
                    'CLMTemplateDocumentSections': '{!$Label.vlocity_cmt__CLMTemplateDocumentSections}',
                    'CLMTemplateChooseClause': '{!$Label.vlocity_cmt__CLMTemplateChooseClause}',
                    'CLMTemplateNoGenericClause': '{!$Label.vlocity_cmt__CLMTemplateNoGenericClause}',
                    'CLMTemplateSearchClauses': '{!$Label.vlocity_cmt__CLMTemplateSearchClauses}',
                    'CLMTemplateEmbedTemplate': '{!$Label.vlocity_cmt__CLMTemplateEmbedTemplate}',
                    'CLMTemplateSearchTempaltes': '{!$Label.vlocity_cmt__CLMTemplateSearchTempaltes}',
                    'CLMTemplateEnterTheSectionName': '{!$Label.vlocity_cmt__CLMTemplateEnterTheSectionName}',
                    'CLMTemplateSectionType': '{!$Label.vlocity_cmt__CLMTemplateSectionType}',
                    'CLMTemplateSectionApplicableItemTypes': '{!$Label.vlocity_cmt__CLMTemplateSectionApplicableItemTypes}',
                    'CLMTemplateSectionProperties': '{!$Label.vlocity_cmt__CLMTemplateSectionProperties}',
                    'CLMTemplateAutoNumber': '{!$Label.vlocity_cmt__CLMTemplateAutoNumber}',
                    'CLMTemplateResetAutoNumber': '{!$Label.vlocity_cmt__CLMTemplateResetAutoNumber}',
                    'CLMTemplateAutoAddSectionKey': '{!$Label.vlocity_cmt__CLMTemplateAutoAddSectionKey}',
                    'CLMTemplateSectionKey': '{!$Label.vlocity_cmt__CLMTemplateSectionKey}',
                    'CLMTemplateExtractEmbeddedTemplate': '{!$Label.vlocity_cmt__CLMTemplateExtractEmbeddedTemplate}',
                    'CLMTemplateConstructTable': '{!$Label.vlocity_cmt__CLMTemplateConstructTable}',
                    'CLMTemplateRedHexColorCode': '{!$Label.vlocity_cmt__CLMTemplateRedHexColorCode}',
                    'CLMTemplateFillColor': '{!$Label.vlocity_cmt__CLMTemplateFillColor}',
                    'CLMTemplateBorder': '{!$Label.vlocity_cmt__CLMTemplateBorder}',
                    'CLMTemplateAllColumnsHeaderToken': '{!$Label.vlocity_cmt__CLMTemplateAllColumnsHeaderToken}',
                    'CLMTemplateEnterTotalToken': '{!$Label.vlocity_cmt__CLMTemplateEnterTotalToken}',
                    'CLMTemplateAddColumn': '{!$Label.vlocity_cmt__CLMTemplateAddColumn}',
                    'CLMTemplateConditionalProducts': '{!$Label.vlocity_cmt__CLMTemplateConditionalProducts}',
                    'CLMTemplateApexClassImplementVlocityOpenInterface': '{!$Label.vlocity_cmt__CLMTemplateApexClassImplementVlocityOpenInterface}',
                    'CLMTemplateAdvEntityFilters': '{!$Label.vlocity_cmt__CLMTemplateAdvEntityFilters}',
                    'CLMTemplateSearchAvailProducts': '{!$Label.vlocity_cmt__CLMTemplateSearchAvailProducts}',
                    'CLMTemplateSearchAvailProd': '{!$Label.vlocity_cmt__CLMTemplateSearchAvailProd}',
                    'CLMTemplateEntityConditionalFilters': '{!$Label.vlocity_cmt__CLMTemplateEntityConditionalFilters}',
                    'CLMTemplateBasicProductFilters': '{!$Label.vlocity_cmt__CLMTemplateBasicProductFilters}',
                    'CLMTemplateEnterSelectCreateEntityFilterName': '{!$Label.vlocity_cmt__CLMTemplateEnterSelectCreateEntityFilterName}',
                    'CLMTemplateEntityFilterName': '{!$Label.vlocity_cmt__CLMTemplateEntityFilterName}',
                    'CLMTemplateEntityFilterFormula': '{!$Label.vlocity_cmt__CLMTemplateEntityFilterFormula}',
                    'CLMTemplateCreateFilter': '{!$Label.vlocity_cmt__CLMTemplateCreateFilter}',
                    'CLMTemplateSelectExistingEntityFilter': '{!$Label.vlocity_cmt__CLMTemplateSelectExistingEntityFilter}',
                    'CLMTemplateRemoveEntityFilter': '{!$Label.vlocity_cmt__CLMTemplateRemoveEntityFilter}',
                    'CLMTemplateAdvSearch': '{!$Label.vlocity_cmt__CLMTemplateAdvSearch}',
                    'CLMTemplateClearSearch': '{!$Label.vlocity_cmt__CLMTemplateClearSearch}',
                    'CLMTemplateSearchTemplateName': '{!$Label.vlocity_cmt__CLMTemplateSearchTemplateName}',
                    'CLMTemplateSearchSectionName': '{!$Label.vlocity_cmt__CLMTemplateSearchSectionName}',
                    'CLMTemplateSearchSectionContent': '{!$Label.vlocity_cmt__CLMTemplateSearchSectionContent}',
                    'CLMTemplateViewSettings': '{!$Label.vlocity_cmt__CLMTemplateViewSettings}',
                    'CLMTemplateAddNewSection': '{!$Label.vlocity_cmt__CLMTemplateAddNewSection}',
                    'CLMTemplateApexClassExtendDocTemplateMappingAbstractClass': '{!$Label.vlocity_cmt__CLMTemplateApexClassExtendDocTemplateMappingAbstractClass}',
                    'CLMContractDocDragDropFiles': '{!$Label.vlocity_cmt__CLMContractDocDragDropFiles}',
                    'CLMContractDocBrowse': '{!$Label.vlocity_cmt__CLMContractDocBrowse}',
                    'CLMTemplateDocMaxFileSize': '{!$Label.vlocity_cmt__CLMTemplateDocMaxFileSize}',
                    'CLMTemplateAttachFile': '{!$Label.vlocity_cmt__CLMTemplateAttachFile}',
                    'CLMTemplateDownloadFile': '{!$Label.vlocity_cmt__CLMTemplateDownloadFile}',
                    'CLMTemplateReplaceFile': '{!$Label.vlocity_cmt__CLMTemplateReplaceFile}',
                    'CLMTemplateViewFile': '{!$Label.vlocity_cmt__CLMTemplateViewFile}',
                    'CLMTemplateUseExistingFile': '{!$Label.vlocity_cmt__CLMTemplateUseExistingFile}',
                    'CLMDocGenDownloadWord': '{!$Label.vlocity_cmt__CLMDocGenDownloadWord}',
                    'CLMDocGenDownloadPowerPoint': '{!$Label.vlocity_cmt__CLMDocGenDownloadPowerPoint}',
                    'CLMDocGenDownloadPDF': '{!$Label.vlocity_cmt__CLMDocGenDownloadPDF}',
                    'CLMTemplateViewTokenList': '{!$Label.vlocity_cmt__CLMTemplateViewTokenList}',
                    'CLMTemplateClauseReplacedMessage': '{!$Label.vlocity_cmt__CLMTemplateClauseReplacedMessage}',
                    'CLMTemplateDownloadFinalVersion': '{!$Label.vlocity_cmt__CLMTemplateDownloadFinalVersion}',
                    'CLMTemplateUseFinalVersion': '{!$Label.vlocity_cmt__CLMTemplateUseFinalVersion}',
                    'CLMTemplateDownloadOriginalFile': '{!$Label.vlocity_cmt__CLMTemplateDownloadOriginalFile}',
                    'CLMTemplateFileUploaded': '{!$Label.vlocity_cmt__CLMTemplateFileUploaded}',
                    'VlocityPDFTronNoSystemUserMsg':'{!$Label.vlocity_cmt__VlocityPDFTronNoSystemUserMsg}',
                    'VCloudTemplateDocumentGenerationMechanism': '{!$Label.vlocity_cmt__VCloudTemplateDocumentGenerationMechanism}',
                    'VCloudTemplatePdfGenerationMechanism': '{!$Label.vlocity_cmt__VCloudTemplatePdfGenerationMechanism}',
                    'CLMContinueCreatingNewDocumentTemplateVersion' : '{!$Label.vlocity_cmt__CLMContinueCreatingNewDocumentTemplateVersion}',
                };

                angular.module('documentTemplateApp')
                .value('IsFoundation', {!JSENCODE(IF(isFoundation, "true", "false"))}) 
                .value('nameSpacePrefix', window.nameSpacePrefix)
                .value('DocTemplateFieldMappings', window.DocTemplateFieldMappings)
                .value('bOmnistudio', window.bOmnistudio)
                .controller('initDocumentTemplateCtrl', function($scope, CONST, IsFoundation, nameSpacePrefix) {
                    'use strict';
                    $scope.pageParams = {
                        'templateType': '{!JSENCODE(LOWER($CurrentPage.parameters.templateType))}' || CONST.UNDEFINED,
                        'templateId': '{!JSENCODE($CurrentPage.parameters.templateId)}' || CONST.UNDEFINED,
                        'templateData': null,
                        'templateMetadata': null
                    };
                    if(IsFoundation) {
                        if($scope.pageParams.templateType === undefined || $scope.pageParams.templateId === undefined){ //If this is a new page
                            $scope.pageParams.templateType = CONST.DOCX;
                        }
                    }
                    $scope.CONST = CONST;
                });

                function launchFilePreview(contentVersionId) {
                    $Lightning.use('c:FilePreviewApp', function() {
                        $Lightning.createComponent(
                            'c:FilePreviewComponent', 
                            {'contentVersionId': contentVersionId}, 
                            'lightningFilePreview', 
                            function(cmp) {}
                        );
                    });
                }
            </script>
        </body>
    </html>
</apex:page>